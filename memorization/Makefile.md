# Makefile

- make는 현재 디렉터리에 있는 Makefile을 참조한다
  - 현재 디렉터리에 Makefile이 존재하지 않으면 에러가 발생한다

---

- Makefile 작성 중에는 들여쓰기시 꼭 TAB 키를 사용해야한다

---

- 규칙(rule)은 타깃(target)과 선행조건(prerequisite)과 레시피(recipe)로 구성된다
- 타깃의 이름은 현재 디렉터리에 존재하는 같은 이름의 파일을 가리킨다
- 타깃은 하나의 규칙의 제목이 된다
- 선행조건은 작업을 하기 전에 먼저 해야할 문제를 의미한다
  - 한 규칙에서 선행조건은 현재 디렉터리에서의 파일명이 되기도하고, 다른 규칙의 타깃을 가리키기도 한다 (다른 규칙의 타깃에 의존)
- 레시피는 타깃을 생성하기 위해 이루어지는 작업
  - 하나의 규칙은 하나 이상의 레시피를 가질 수 있다

---

- (when: make 명령 이후에) (what: 선행조건이 가리키는 파일이) (how: 수정되었다면) (then: 레시피를 실행한다/ 실행하지 않는다)
  - make 유틸리티는 선행조건 파일의 수정/생성시간과 타깃파일의 수정/생성시간을 비교하여 결정내린다

---

- make 명령시 타깃을 지정하지 않으면 Makefile에서 가장 처음에 등장하는 타깃을 찾아 그 규칙을 실행한다

---

- 타깃명과 같은 파일이 존재하는지 확인한다
  - 타깃파일이 존재하면 선행조건파일과 타임스탬프 비교를 한다
  - 타깃파일이 존재하지 않는다면, 선행조건과 레시피에 따라 타깃파일을 생성한다
- 유사타깃(Phony target)의 특징은 아무 조건 없이 레시피를 수행 (선행조건을 지정하지 않음)
  - .PHONY는 현재 디렉터리에 같은 이름의 파일명이 있어도 무시하고 레시피를 실행하라는 뜻
- make 유틸리티는 'makefile', 'Makefile', 'GNUMakefile'을 찾는다
  - '-f' 옵션을 추가시 다른 이름의 파일도 실행가능
- 주석은 '#'을 붙인다
- 선행조건을 타깃으로 가진 규칙이 있는지 찾습니다
  - 타깃명과 같은 이름을 가진 파일이 현재 디렉터리에 존재하는지 확인합니다
- 암시적 규칙: make에는 어떤 확장자를 가진 파일에서 다른 확장자를 가지는 파일을 생성하는 규칙을 내장하고 있다
  - 해당 규칙이 없어도, make는 선행조건파일의 확장자를 보고 사용할 컴파일러와 생성할 파일명을 유추(내장규칙 검색) 하여 컴파일
