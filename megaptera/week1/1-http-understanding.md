---
layout  : wiki
title   : http의 이해
summary : 
date    : 2023-07-27 00:10:13 +0900
updated : 2023-07-27 00:10:13 +0900
tag     : week1 megaptera
toc     : true
public  : true
parent  : [[/megaptera/week1]]
latex   : false
resource: 226A5021-A921-483F-8DED-3EBFFFE497D0
---
* TOC
{:toc}

# 1. HTTP의 이해

## HTTP(Hypertext Transfer Protocol)

### HTTP 정의

- World Wide Web에서 통신하는데 사용하는 프로토콜 프로그램이다.
- HTML 같은 하이퍼미디어 문서를 전송하기 위한 (OSI 7 계층 관점에서) 애플리케이션레이어 프로토콜이다.

## World Wide Web  

### WWW 정의

- Internet을 통해 접근 가능한 (공용) 웹페이지의 상호연결 시스템

### 구성요소

- HTTP: 서버와 클라이언트 간의 데이터 전송 프로토콜
- URL/URI: 웹 요소에 접근하기 위한 식별자
- HTML: 웹 문서(요소)

## Internet  

### Internet 정의

- TCP/IP(프로토콜 세트)을 사용하는 네트워크


## HTTPS

### HTTPS 정의

- 보안 전송 계층을 통해 전송되는 HTTP이다.
- HTTP 하부에 전송레벨 보안 계층(SSL 또는 TLS)을 제공한다.

### HTTP vs HTTPS

- HTTP는 암호화되지 않은 HTTP 메세지를 TCP를 통해 보낸다.  
  HTTP: 네트워크 인터페이스 -> IP -> TCP -> HTTP
- HTTPS는 HTTP 메세지를 TCP로 보내기 전에 암호화하는 보안 계층으로 보낸다.  
  HTTPS: 네트워크 인터페이스 -> IP -> TCP -> SSL/TLS -> HTTP

### 더 알아볼 것

- SSL와 HTTPS에서 이용되는 암호 인코딩 기법  
  키워드: 암호, 키, 대칭키 암호체계, 비대칭키 암호체계, 공개키 암호법, 디지털 서명, 디지털 인증서
- HTTPS 내부동작  
  HTTPS스킴(SSL은 복잡한 바이너리 프로토콜) -> 보안전송셋업 -> SSL 핸드셰이크 -> 서버인증서/사이트인증서 검사
- 프락시와 HTTPS(보안)

## 클라이언트-서버 모델

### 클라이언트-서버모델

- 서비스 요청자인 클라이언트와 서비스 자원 제공자인 서버 간에 작업을 분리해주는 분산 애플리케이션 구조이며, 네트워크 아키텍처이다.

## stateless와 stateful

### stateless 정의

- HTTP 트랜잭션은 상태가 없다 (연결 자체에 대한 정보를 저장하지 않는다)
- 매 요청은 일회성이고 독립적이다

### HTTP가 사용자를 식별하기 위해 사용하는 기술들 (stateful)

- HTTP 헤더:  
  From 헤더, User-Agent 헤더, Referer 헤더를 이용하여 식별
- 클라이언트 IP 주소
- 사용자 로그인
- 뚱뚱한 URL
- 쿠키

## HTTP Cookie와 HTTP Session

### HTTP Cookie

#### Cookie 정의

- 쿠키는 서버가 클라이언트(사용자)에게 적어 붙이는 스티커와 같다
- 쿠키는 서버가 사용자 웹 브라우저에 전송하는 데이터 조각이다  
  브라우저는 그 데이터 조각을 저장하고, 동일한 서버에 재 요청시 저장된 데이터(데이터 조각)을 함께 전송한다
- 쿠키를 통해 서버는 두 요청이 동일한 브라우저에서 들어온건지 판단할 수 있다
- 브라우저는 서버로부터 온 Set-Cookie 헤더에 있는 쿠키 콘테츠를 브라우저 쿠키 데이터베이스에 저장한다  
  사용자가 다시 서버에 접근할 때마다 Cookie 요청 헤더에 쿠키를 기술해 함께 전송한다

#### 쿠키의 타입

- 쿠키가 파기되는 시점으로 세션쿠키와 지속쿠키로 나눌 수 있다
- Expires 속성과 Max-age 속성을 수정함으로써 삭제할 수 있다

#### 쿠키와 보안

- Secure 속성은 HTTPS 프로토콜 상에서 암호화된 요청일 경우에만 전송된다
- HttpOnly 속성은 브라우저에서 쿠키에 접근할 수 없도록 제한한다  

#### 쿠키의 스코프

- Domain 속성은 어떤 사이트가 그 쿠키를 읽을 수 있는지 제어한다
- Path 속성은 웹 사이트 일부에만 쿠키를 적용할 수 있게한다

## HTTP Session

#### Session 정의

- 클라이언트(브라우저) 별로 서버에 저장되는 정보이다.

#### 동작순서

1. 클라이언트가 서버에 요청을 보내면, 서버는 클라이언트를 식별하는 session id를 만든다
2. 서버는 session id에 해당하는 key와 value를 이용하는 저장소인 HttpSession을 생성
3. 서버는 session id를 저장하고 있는 쿠키를 생성하여 클라이언트에 전송
4. 클라이언트는 서버 측에 요청할 때마다 session id를 저장하고 있는 쿠키를 함께 전송
5. 서버는 요청 쿠키에 있는 session id를 이용해서 해당 HttpSession을 찾는다

#### 더 알아볼 것

- 성능상의 이유로 쿠키보다는 Modern APIs(localStorage와 sessionStorage), indexedDB을 이용하여 정보저장

## HTTP 메시지

### 정의

- HTTP 애플리케이션 간에 주고받는 데이터 블록
- 요청: 클라이언트 -> 서버  
  웹 서버에 어떤 동작을 요구
- 응답: 서버 -> 클라이언트  
  요청의 결과를 보내준다

### HTTP 메시지 구조

- 구조: 시작줄(어떤 메시지인지), 헤더 블록(속성), 본문(데이터)
- 시작줄과 헤더는 줄 단위로 분리된 ASCII 문자열이다
- 각 줄은 CRLF - 캐리지리턴(ASCII 13)과 개행문자(ASCII 10)으로 구성된 줄바꿈 문자열로 끝난다
- 본문은 비어있거나, 텍스트 혹은 바이너리 데이터일 수 있다

### 더 알아볼 것

- 트랜잭션 방향을 표현하기  위한 인바운드, 아웃바운드, 다운스트림, 업스트림 용어

## HTTP 요청

### 시작 줄start line

1. HTTP method: 클라이언트가 서버에게 리소스에 대해 수행해주길 바라는 동작
2. 요청 URL: 리소스를 지칭한다
3. HTTP 버전

- 공백으로 구분한다  

### HTTP method

|메서드|설명|메시지 본문여부|
|---|---|---|
|GET|서버에서 어떤 문서를 가져온다|X|
|HEAD|서버에서 어떤 문서의 헤더만 가져온다|X|
|POST|서버가 처리해야 할 데이터를 보낸다|O|
|PUT|서버에 본문을 저장한다|O|
|TRACE|메시지가 서버에 도달하는 과정을 추적한다|X|
|OPTIONS|서버가 어떤 메서드를 수행할 수 있는지 확인|X|
|DELETE|서버에서 문서를 제거|X|

### 멱등(idempotent)

- N번 실행해도 같은 결과를 반환하면 그 트랜잭션은 멱등하다

## HTTP 응답

### 상태 줄status line

1. HTTP버전: 응답 메시지에 쓰인 HTTP의 버전
2. 상태코드: 클라이언트에게 무엇이 일어났는지 말해준다
3. 상태 텍스트: 상태 코드에 대한 설명
(공백으로 구분한다)

### 상태코드

|전체범위|정의된 범위|분류|
|---|---|---|
|100-199|100-101|정보|
|200-299|200-206|성공|
|300-399|300-305|리다이렉션|
|400-499|400-415|클라이언트 에러|
|500-599|500-505|서버에러|

### 300-399 리다이렉션 상태코드

- 리다이렉션 상태코드는 클라이언트가 찾고하는 리소스가 다른 위치에 있다고 말해주거나, 해당 리소스 내용 대신 다른 대안 응답을 제공
- 리소스 위치가 변경되었다면 Location 헤더를 통해 위치를 알려준다

## 헤더

### 정의

- 시작줄 다음에 0개, 1개 혹은 여러 개의 HTTP 헤더가 온다
- HTTP 헤더는 요청, 응답 메시지에 추가 정보를 더한다
- 이름, 쉼표

### 분류

- 일반헤더(General Headers): 요청과 응답 양쪽에 사용가능
- 요청헤더(Request Headers)
- 응답헤더(Response Headers)
- Entity header: 본문 크기, 콘텐츠, 리소스 그자체를 서술
- 확장헤더(Extension Headers): 명세에 정의되지 않은 헤더

### HTTP entity header: Content-Type

#### 정의

- Content-Type 헤더는 본문의 MIME 타입을 기술한다

### MIME 타입

- MIME 타입은 전달되는 데이터 매체의 기저 형식(ex. HTML파일, 마이크로소프트 워드문서, MPEG 비디오 등)의 표준화된 이름
- 주 미디어 타입 + 빗금(/) + 부 타입으로 이루어진다

### 매개변수 charset

- 본문의 비트 집합을 텍스트 파일 글자로 변환하기 위한 매개변수이다

### Content-Type: multipart/form-data

- 브라우저에서 서버로 HTML Form 제출시 사용한다
- multipart는 HTML Form에 여러 다른 종류와 길이의 값으로 채워진 값을 허용한다
- boundary: 본문의 서로 다른 부분을 구분하기 위한 구분자
- Content-Disposition: 필드에 대한 정보제공

